<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
  <title>Magic Connect</title>
  <style>
    
    body { 
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif; 
      background: #0f0f0f; 
      margin: 0px; 
      color: #eee; 
    }

    .date-picker { 
      display: flex; 
      justify-content: center; 
      align-items: center; 
      gap: 10px; 
      margin-bottom: 0px; 
      user-select: none; 
    }

    .date-picker button { 
      background: linear-gradient(to left, #333, #333);
      border: none; 
      color: #eee; 
      padding: 10px 16px; 
      border-radius: 8px; 
      cursor: pointer; 
      font-size: 1.2rem; 
      transition: background-color 0.3s ease; 
    }

    .date-picker button:hover { 
      background: #444; 
    }

    .date-picker .date-display { 
      font-family: 'Cairo', sans-serif; 
      font-weight: 700; 
      font-size: 1.2rem; 
      min-width: 160px; 
      text-align: center; 
      color: #fff; 
      background: #272727; 
      padding: 8px 16px; 
      border-radius: 8px; 
      user-select: none; 
    }

    .league { 
      margin-bottom: 20px; 
      background: #333; 
      border-radius: 8px; 
      box-shadow: 0 2px 8px rgb(0 0 0 / 0.7); 
      padding: 0; 
      overflow: hidden; 
      
    }

    .league-header { 
      display: flex; 
      align-items: center; 
      gap: 10px; 
      padding: 20px 15px; 
      background: #222; 
      color: #eee; 
      border-radius: 8px 8px 0 0; 
      margin-bottom: 0; 
      
    }

    .league-header h2 { 
      color: #fff; 
      font-size: 1rem; 
      margin: 0; 
      font-family: 'Cairo', sans-serif; 
    }

    .league-header img { 
      width: 40px; 
      height: 40px; 
      object-fit: contain; 
    }

    .match { 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      border-top: 1px solid #777; 
      padding: 12px 0; 
      position: relative;
      transition: all 0.2s ease;
      outline: none !important;
      cursor: pointer;
    }

    .match:first-child { 
      border-top: none; 
    }

    .team { 
      display: flex; 
      flex-direction: column; 
      align-items: center; 
      width: 110px; 
      cursor: default; 
    }

    .team img { 
      width: 50px; 
      height: 50px; 
      object-fit: contain; 
      margin-bottom: 6px; 
      
      pointer-events: none; 
    }

    .team-name { 
      font-size: 0.8rem; 
      text-align: center; 
      white-space: nowrap; 
      overflow: hidden; 
      text-overflow: ellipsis; 
      max-width: 100%; 
      color: #fff; 
      user-select: none; 
      pointer-events: none; 
      font-family: 'Cairo', sans-serif; 
    }

    .center-info { 
      flex: 1; 
      max-width: 160px; 
      text-align: center; 
      font-weight: 600; 
      font-size: 1rem; 
      color: #ccc; 
      user-select: none; 
      display: flex; 
      flex-direction: column; 
      align-items: center; 
      gap: 6px; 
    }

    .score { 
      font-size: 1rem; 
      font-weight: 700; 
      color: #fff; 
      background: linear-gradient(135deg, #333, #555, #333); 
      padding: 6px 16px; 
      border-radius: 25px; 
      min-width: 70px; 
      user-select: none; 
      transition: background-color 0.3s ease; 
      text-shadow: 0 0 4px rgba(0,0,0,0.5); 
      border: 1px solid #1b2733; 
      font-family: 'Cairo', sans-serif; 
    }

    .status { 
      margin-top: 4px; 
      font-size: 0.8rem; 
      font-family: 'Cairo', sans-serif; 
      user-select: none; 
      padding: 3px 5px; 
      border-radius: 20px; 
      min-width: 80px; 
      text-align: center; 
      transition: all 0.3s ease; 
      box-shadow: none; 
      border: none; 
      font-weight: 600; 
    }

    .status.ended { 
      color: #fff; 
      background-color: #5c6bc0; 
      border: 1px solid #3f51b5; 
      box-shadow: 0 0 10px #3f51b5aa; 
      font-weight: 700; 
      text-shadow: 0 0 4px #3949ab; 
      letter-spacing: 0.5px; 
    }

    .status.live { 
      color: #fff; 
      font-weight: 700; 
      background: linear-gradient(270deg, #e74c3c, #c0392b, #e74c3c); 
      background-size: 600% 600%; 
      animation: gradientShift 4s ease infinite, blink 1.5s infinite; 
      border: 1px solid #c0392b; 
      box-shadow: 0 0 12px #e74c3caa; 
      text-shadow: 0 0 5px #c0392b; 
    }

    .status.upcoming { 
      color: #fff; 
      background: linear-gradient(45deg, #3498db, #2980b9); 
      border: 1px solid #2980b9; 
      box-shadow: 0 0 8px #3498dbaa; 
      font-weight: 700; 
      text-shadow: 0 0 3px #1c5980; 
    }

    .status.postponed { 
      color: #fff; 
      background: linear-gradient(45deg, #f39c12, #d35400); 
      border: 1px solid #e67e22; 
      box-shadow: 0 0 10px #e67e2288; 
      font-weight: 700; 
      text-shadow: 0 0 4px #d35400; 
      letter-spacing: 0.5px; 
    }

    @keyframes blink { 
      0%, 100% { opacity: 1; } 
      50% { opacity: 0.6; } 
    }

    @keyframes gradientShift { 
      0% {background-position:0% 50%} 
      50% {background-position:100% 50%} 
      100% {background-position:0% 50%} 
    }

    #splashScreen {
      opacity: 1;
      transition: opacity 0.6s ease;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #000000, #001a11);
      z-index: 99999;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #splashScreen i {
      width: 80px;
      height: 80px;
      font-size: 60px;
      line-height: 80px;
      color: #00ff88;
    }

    .pure-loader {
      width: 60px;
      height: 60px;
      border: 6px solid #444;
      border-top: 6px solid #fff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .rotate {
      animation: spin 0.6s linear;
    }

    #matches-container {
      padding: 15px;
    }

    /* نافذة التفاصيل المنبثقة */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.8);
      z-index: 1000;
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: #272727;
      border-radius: 12px;
      width: 95%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
      transform: translateY(20px);
      transition: transform 0.3s ease;
      border: 1px solid #444;
    }

    .modal-overlay.active .modal-content {
      transform: translateY(0);
    }

    .modal-header {
      padding: 15px;
      background: #333;
      border-radius: 12px 12px 0 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #555;
    }

    .modal-title {
      font-family: 'Cairo', sans-serif;
      font-weight: 700;
      font-size: 1.2rem;
      color: #fff;
      margin: 0;
    }

    .close-modal {
      background: none;
      border: none;
      color: #fff;
      font-size: 1.5rem;
      cursor: pointer;
      padding: 5px;
    }

    .modal-body {
      padding: 15px;
    }

    /* أنماط التبويبات */
    .tabs-container {
      display: flex;
      border-bottom: 1px solid #444;
      margin-bottom: 15px;
      overflow-x: auto;
    }

    .tab {
      padding: 10px 15px;
      cursor: pointer;
      font-family: 'Cairo', sans-serif;
      font-weight: 700;
      color: #aaa;
      border-bottom: 3px solid transparent;
      transition: all 0.3s ease;
      white-space: nowrap;
      outline: none;
    }

    .tab.active {
      color: #fff;
      border-bottom-color: #5c6bc0;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    /* أنماط محتوى التبويبات */
    .match-details-header {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #444;
    }

    .match-teams-container {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      gap: 20px;
    }

    .match-team {
      display: flex;
      flex-direction: column;
      align-items: center;
      flex: 1;
      max-width: 120px;
    }

    .match-team img {
      width: 50px;
      height: 50px;
      object-fit: contain;
      margin-bottom: 8px;
      background: #fff;
      border-radius: 50%;
      padding: 3px;
      border: 2px solid #444;
    }

    .match-team-name {
      font-family: 'Cairo', sans-serif;
      font-size: 0.9rem;
      font-weight: 700;
      text-align: center;
      color: #fff;
      margin-top: 3px;
    }

    .match-score-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0 10px;
    }

    .match-score {
      font-family: 'Cairo', sans-serif;
      font-size: 1.8rem;
      font-weight: 700;
      color: #fff;
      margin: 0;
      text-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
    }

    .match-status-container {
      width: 100%;
      display: flex;
      justify-content: center;
      margin-top: 10px;
    }

    .match-status {
      font-family: 'Cairo', sans-serif;
      font-size: 0.85rem;
      padding: 6px 20px;
      border-radius: 20px;
      font-weight: 700;
      text-align: center;
    }

    .match-status.ended {
      background: #5c6bc0;
      color: #fff;
      border: 1px solid #3f51b5;
      box-shadow: 0 0 10px #3f51b5aa;
    }

    .match-status.live {
      background: linear-gradient(270deg, #e74c3c, #c0392b, #e74c3c);
      color: #fff;
      animation: gradientShift 4s ease infinite, blink 1.5s infinite;
      border: 1px solid #c0392b;
      box-shadow: 0 0 12px #e74c3caa;
    }

    .match-status.upcoming {
      background: linear-gradient(45deg, #3498db, #2980b9);
      color: #fff;
      border: 1px solid #2980b9;
      box-shadow: 0 0 8px #3498dbaa;
    }

    .match-status.postponed {
      background: linear-gradient(45deg, #f39c12, #d35400);
      color: #fff;
      border: 1px solid #e67e22;
      box-shadow: 0 0 10px #e67e2288;
    }

    .match-info-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-bottom: 20px;
    }

    .info-item {
      background: linear-gradient(135deg, #222, #444, #222);
      padding: 12px;
      border-radius: 8px;
      border-left: 3px solid #999;
    }

    .info-label {
      font-family: 'Cairo', sans-serif;
      font-size: 1rem;
      color: #aaa;
      margin-bottom: 5px;
    }

    .info-value {
      font-family: 'Cairo', sans-serif;
      font-size: 0.9rem;
      color: #fff;
      font-weight: 600;
    }

    .section-title {
      font-family: 'Cairo', sans-serif;
      font-size: 1rem;
      color: #fff;
      margin: 20px 0 10px;
      padding-bottom: 5px;
      border-bottom: 1px solid #444;
    }

    .formations-container {
      display: flex;
      justify-content: space-between;
      gap: 20px;
      margin-bottom: 20px;
    }

    .formation {
      flex: 1;
      background: linear-gradient(135deg, #222, #444, #222);
      padding: 15px;
      border-radius: 8px;
    }

    .formation-title {
      font-family: 'Cairo', sans-serif;
      font-size: 0.9rem;
      color: #fff;
      text-align: center;
      margin-bottom: 10px;
    }

    .formation-value {
      font-family: 'Cairo', sans-serif;
      font-size: 1.2rem;
      font-weight: 700;
      text-align: center;
      margin-bottom: 15px;
      color: #50C878;
      text-shadow: 0 0 5px rgba(0, 0, 0, 0.7);
    }

    .coach-info {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px dashed #444;
    }

    .coach-info img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
    }

    .coach-name {
      font-family: 'Cairo', sans-serif;
      font-size: 0.9rem;
      color: #fff;
    }

    .players-list {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
    }

    .player-item {
      background: linear-gradient(135deg, #222, #444, #222);
      padding: 8px;
      border-radius: 5px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .player-item img {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      object-fit: cover;
    }

    .player-name {
      font-family: 'Cairo', sans-serif;
      font-size: 0.8rem;
      color: #fff;
    }

    .player-number {
      font-family: 'Cairo', sans-serif;
      font-size: 0.8rem;
      color: #FFD700;
      font-weight: 700;
      margin-left: auto;
      background: rgba(0, 0, 0, 0.3);
      padding: 2px 5px;
      border-radius: 3px;
    }

    .events-container, .stats-container {
      background: linear-gradient(135deg, #222, #444, #222);
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .event-item, .stat-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px dashed #444;
    }

    .event-time, .stat-name {
      font-family: 'Cairo', sans-serif;
      font-size: 0.8rem;
      color: #aaa;
    }

    .event-desc, .stat-value {
      font-family: 'Cairo', sans-serif;
      font-size: 0.8rem;
      color: #fff;
    }

    .loading-details {
      text-align: center;
      padding: 30px;
      font-family: 'Cairo', sans-serif;
      color: #fff;
    }

    .loading-spinner {
      border: 3px solid #333;
      border-top: 3px solid #eee;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      margin: 0 auto 15px;
    }

    /* أنماط ركلات الترجيح */
    .penalty-shootout {
      background: #2a2a2a;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
      border: 1px solid #3a3a3a;
    }

    .penalty-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      gap: 20px;
    }

    .penalty-team-header {
      display: flex;
      flex-direction: column;
      align-items: center;
      flex: 1;
    }

    .penalty-team-logo {
      width: 50px;
      height: 50px;
      object-fit: contain;
      background: #fff;
      border-radius: 50%;
      padding: 5px;
      margin-bottom: 8px;
      border: 2px solid #444;
    }

    .penalty-team-name {
      font-family: 'Cairo', sans-serif;
      font-size: 0.9rem;
      font-weight: 700;
      text-align: center;
      color: #fff;
      margin-bottom: 5px;
    }

    .penalty-score {
      font-family: 'Cairo', sans-serif;
      font-size: 1.5rem;
      font-weight: 700;
      color: #fff;
      background: #8b0000;
      padding: 5px 15px;
      border-radius: 20px;
      min-width: 40px;
      text-align: center;
    }

    .penalty-kicks-container {
      display: flex;
      gap: 10px;
    }

    .penalty-kicks-column {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .penalty-separator {
      width: 2px;
      background: #444;
      margin: 0 10px;
    }

    .penalty-kick {
      display: flex;
      align-items: center;
      padding: 10px;
      border-radius: 8px;
      background: #333;
      transition: all 0.3s ease;
    }

    .penalty-kick.scored {
      background: rgba(91, 210, 134, 0.1);
      border-left: 3px solid #5bd286;
    }

    .penalty-kick.missed {
      background: rgba(231, 76, 60, 0.1);
      border-left: 3px solid #e74c3c;
    }

    .kick-number {
      font-family: 'Cairo', sans-serif;
      font-weight: 700;
      color: #aaa;
      width: 20px;
      text-align: center;
      font-size: 0.8rem;
    }

    .player-info {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 0 10px;
    }

    .player-avatar {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid #444;
    }

    .player-name {
      font-family: 'Cairo', sans-serif;
      font-size: 0.85rem;
      color: #fff;
    }

    .kick-result {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
    }

    .penalty-kick.scored .kick-result {
      background: rgba(91, 210, 134, 0.2);
      color: #5bd286;
    }

    .penalty-kick.missed .kick-result {
      background: rgba(231, 76, 60, 0.2);
      color: #e74c3c;
    }

    /* أنماط الإحصائيات */
    .stats-comparison {
      background: linear-gradient(135deg, #222, #333, #222);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      border: 1px solid #3a3a3a;
      text-align: center;
    }

    .stats-header {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 25px;
      gap: 40px;
    }
    

    .stats-team {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 120px;
    }

    .stats-logo {
      width: 50px;
      height: 50px;
      object-fit: contain;
      background: #fff;
      border-radius: 50%;
      padding: 5px;
      margin-bottom: 8px;
      border: 2px solid #444;
    }

    .stats-team-name {
      font-family: 'Cairo', sans-serif;
      font-size: 0.9rem;
      font-weight: 700;
      text-align: center;
      color: #fff;
    }

    .home-team .stats-team-name {
      color: #F44336;
    }

    .away-team .stats-team-name {
      color: #1e90ff;
    }

    .vs-container {
      background: linear-gradient(135deg, #222, #444);
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 3px solid #fff;
      box-shadow: 0 0 15px rgba(0,0,0,0.5);
    }

    .vs-text {
      font-family: 'Cairo', sans-serif;
      font-size: 1.2rem;
      font-weight: 900;
      color: #fff;
      text-shadow: 0 0 5px rgba(0,0,0,0.7);
    }

    .stats-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .stat-item {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .stat-row {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
    }

    .stat-name {
      font-family: 'Cairo', sans-serif;
      font-size: 0.85rem;
      color: #bbb;
      min-width: 120px;
      text-align: center;
    }

    .stat-value {
      font-family: 'Cairo', sans-serif;
      font-weight: 700;
      font-size: 0.9rem;
      min-width: 30px;
      text-align: center;
    }

    .home-value {
      color: #F44336;
    }

    .away-value {
      color: #1e90ff;
    }

    .progress-bar-container {
      width: 100%;
      height: 10px;
      background: #333;
      border-radius: 5px;
      overflow: hidden;
      margin: 0 auto;
      max-width: 300px;
      display: flex;
    }

    .home-progress {
      height: 100%;
      background: #F44336;
      transition: width 0.3s ease;
    }

    .away-progress {
      height: 100%;
      background: #1e90ff;
      transition: width 0.3s ease;
    }

    /* أنماط أحداث المباراة */
    .match-events-section {
      margin: 25px 0;
      background: #1a1a1a;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
      font-family: 'Cairo', sans-serif;
      color: #f0f0f0;
      border: 1px solid #333;
    }

    .events-line {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .event-item {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 15px;
      border-radius: 8px;
      background: linear-gradient(135deg, #222, #333, #222);
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.25);
      transition: all 0.3s ease;
      border-right: 5px solid;
    }

    .event-item:hover {
      transform: translateX(5px);
      background: #2e2e2e;
    }

    .event-meta {
      display: flex;
      align-items: center;
      gap: 12px;
      min-width: 100px;
    }

    .event-time {
      font-weight: bold;
      color: #fff;
      background: #3a3a3a;
      padding: 3px 8px;
      border-radius: 20px;
      font-size: 0.9rem;
      border: 1px solid #444;
    }

    .event-icon {
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      background: #2a2a2a;
      border: 2px solid;
      font-size: 0.9rem;
    }

    .event-content {
      flex-grow: 1;
    }

    .event-main-info {
      font-weight: bold;
      font-size: 1rem;
      margin-bottom: 5px;
    }

    .event-type {
      font-size: 0.8rem;
      color: #aaa;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    /* أيقونات وألوان لكل نوع حدث */
    .goal-icon { color: #4CAF50; border-color: #4CAF50; }
    .sub-icon { color: #2196F3; border-color: #2196F3; }
    .yellow-card-icon { color: #FFC107; border-color: #FFC107; }
    .red-card-icon { color: #F44336; border-color: #F44336; }
    .penalty-icon { color: #9C27B0; border-color: #9C27B0; }

    /* ألوان الحدود */
    .event-item.هدف { border-right-color: #4CAF50; }
    .event-item.تبديل-لاعب { border-right-color: #2196F3; }
    .event-item.بطاقة-صفراء { border-right-color: #FFC107; }
    .event-item.بطاقة-حمراء { border-right-color: #F44336; }
    .event-item.ضربة-جزاء { border-right-color: #9C27B0; }

    /* تصميم التبديلات */
    .substitution-container {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 8px;
    }

    .substitution-out {
      color: #F44336;
      font-weight: bold;
    }

    .substitution-arrow {
      color: #777;
      margin: 0 5px;
    }

    .substitution-in {
      color: #4CAF50;
      font-weight: bold;
    }

    /* ألوان اللاعبين حسب الحدث */
    .event-player {
      font-weight: bold;
    }
    .هدف .event-player { color: #4CAF50; }
    .تبديل-لاعب .event-player { color: #e0e0e0; }
    .بطاقة-صفراء .event-player { color: #FFC107; }
    .بطاقة-حمراء .event-player { color: #F44336; }
    .ضربة-جزاء .event-player { color: #9C27B0; }

    .event-assist {
      font-size: 0.9rem;
      color: #aaa;
      margin-left: 8px;
      font-weight: normal;
    }

    /* أنماط الرموز */
    .info-label i, 
    .section-title i, 
    .referee-role i, 
    .coach-name i,
    .player-name i,
    .penalty-player i {
      margin-left: 5px;
      width: 16px;
      text-align: center;
    }

    .event-desc i {
      margin-left: 5px;
    }

    .penalty-outcome i {
      margin-right: 5px;
    }

    /* تعديلات إضافية للرموز */
    .fa-trophy { color: #FFD700; }
    .fa-flag { color: #FF6347; }
    .fa-map-marker-alt { color: #FF4500; }
    .fa-calendar-alt { color: #4682B4; }
    .fa-clock { color: #4682B4; }
    .fa-whistle { color: #32CD32; }
    .fa-user-shield { color: #4169E1; }
    .fa-user-friends { color: #6495ED; }
    .fa-video { color: #FF0000; }
    .fa-tv { color: #1E90FF; }
    .fa-satellite-dish { color: #9370DB; }
    .fa-microphone-alt { color: #FF69B4; }
    .fa-chess { color: #8B4513; }
    .fa-user-tie { color: #708090; }
    .fa-users { color: #556B2F; }
    .fa-user { color: #708090; }
    .fa-chart-bar { color: #20B2AA; }
    .fa-list-ul { color: #6A5ACD; }
    .fa-futbol { color: #32CD32; }
    .fa-exchange-alt { color: #BA55D3; }
    .fa-dot-circle { color: #FF8C00; }
    .fa-crosshairs { color: #DC143C; }
    .fa-check { color: #5bd286; }
    .fa-times { color: #e74c3c; }

    @media (max-width: 600px) {
      .match-info-grid {
        grid-template-columns: 1fr;
      }
      
      .formations-container {
        flex-direction: column;
      }
      
      .players-list {
        grid-template-columns: 1fr;
      }
      
      .penalty-header {
        flex-direction: column;
        gap: 10px;
      }
      
      .penalty-team-header {
        flex-direction: row;
        gap: 15px;
      }
      
      .penalty-kicks-container {
        flex-direction: column;
      }
      
      .penalty-separator {
        width: 100%;
        height: 2px;
        margin: 10px 0;
      }
      
      .stats-header {
        flex-direction: column;
        gap: 15px;
      }
      
      .vs-container {
        transform: rotate(90deg);
        margin: 10px 0;
      }
    }
    
    .referees-container {
      background: linear-gradient(135deg, #222, #444, #222);
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    
    .referee-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px dashed #666;
    }
    
    .referee-role {
      font-family: 'Cairo', sans-serif;
      font-size: 0.8rem;
      color: #aaa;
    }
    
    .referee-name {
      font-family: 'Cairo', sans-serif;
      font-size: 0.8rem;
      color: #fff;
    }
    
    /* زر العودة لأعلى */
    .scroll-to-top {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #ffc107;
      color: #000;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      cursor: pointer;
      z-index: 100;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      box-shadow: 0 2px 10px rgba(0,0,0,0.3);
      border:1px solid #000;
    }
    
    .scroll-to-top.visible {
      opacity: 1;
      visibility: visible;
    }
    
    .scroll-to-top:hover {
      background: #ffc107;
    }
  </style>
</head>
<body>
  
  <div class="scroll-to-top" id="scrollToTop">
    <i class="fas fa-arrow-up"></i>
  </div>
  
  <header>
    <div class="header-buttons">
      <span id="refreshIcon" class="refresh-icon"></span>
    </div>
    
    <div class="header-buttons">
      <a href="go:services"></a>
    </div>
  </header>

  <div class="date-picker">
    <button id="prev-day" aria-label="اليوم السابق">&#x276E;</button>
    <div class="date-display" id="date-display">تحميل...</div>
    <button id="next-day" aria-label="اليوم التالي">&#x276F;</button>
  </div>

  <div id="matches-container"></div>

  <!-- نافذة التفاصيل المنبثقة -->
  <div class="modal-overlay" id="matchDetailsModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">تفاصيل المباراة</h3>
        <button class="close-modal" id="closeModal">&times;</button>
      </div>
      <div class="modal-body" id="modalBody">
        <div class="loading-details">
          <div class="loading-spinner"></div>
          <p>جاري تحميل تفاصيل المباراة...</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    const API_URL = "https://ko.best-goal.live/state.php";
    const PROXY = "https://corsproxy.io/?";
    const DETAILS_API_URL = "https://ko.best-goal.live/state.php?match_id=";

    let selectedDate = new Date();
    selectedDate.setHours(0, 0, 0, 0);
    let currentMatchDetails = null;
    let currentTabIndex = 0;

    function getLocalDateString(date) {
      const year = date.getFullYear();
      const month = (date.getMonth() + 1).toString().padStart(2, "0");
      const day = date.getDate().toString().padStart(2, "0");
      return `${year}-${month}-${day}`;
    }

    function formatArabicDate(date) {
      const months = [
        "يناير", "فبراير", "مارس", "ابريل", "مايو", "يونيو",
        "يوليو", "اغسطس", "سبتمبر", "اكتوبر", "نوفمبر", "ديسمبر"
      ];
      const day = date.getDate();
      const month = months[date.getMonth()];
      const year = date.getFullYear();
      return `${day} ${month} ${year}`;
    }

    function updateDateDisplay() {
      document.getElementById("date-display").textContent = formatArabicDate(selectedDate);
    }

    function parseDateFromParts(dateStr, timeStr) {
      if (!dateStr || !timeStr) return null;

      // تحويل الوقت من "08:00 م" إلى 24 ساعة (20:00)
      let [timePart, period] = timeStr.trim().split(' ');
      let [hours, minutes] = timePart.split(':').map(Number);
      
      if (period === 'م' && hours < 12) hours += 12;
      if (period === 'ص' && hours === 12) hours = 0;

      // إنشاء تاريخ في التوقيت المحلي للخادم (مصر UTC+2)
      const [year, month, day] = dateStr.split('-').map(Number);
      const serverDate = new Date(Date.UTC(year, month - 1, day, hours - 2, minutes));

      // تحويل مباشر إلى التوقيت المحلي للجهاز
      const localDate = new Date(serverDate);

      // إعادة التنسيق إلى "08:00 م"
      let localHours = localDate.getHours();
      const localMinutes = localDate.getMinutes().toString().padStart(2, '0');
      const ampm = localHours >= 12 ? 'م' : 'ص';
      
      localHours = localHours % 12;
      localHours = localHours || 12; // الساعة 0 تصبح 12
      
      return `${localHours}:${localMinutes} ${ampm}`;
    }

    function createMatchHTML(match, leagueIndex, matchIndex) {
      const matchId = `match-${leagueIndex}-${matchIndex}`;
      const leftTeam = match["Team-Left"];
      const rightTeam = match["Team-Right"];
      let status = match["Match-Status"];

      const startTime = parseDateFromParts(match["match_date_time"], match["Match-Start-Time"]);

      let timeStr = "--:--";
      if (startTime) {
        timeStr = startTime;
      }

      const leftGoal = (leftTeam.Goal == null) ? 0 : leftTeam.Goal;
      const rightGoal = (rightTeam.Goal == null) ? 0 : rightTeam.Goal;

      const liveKeywords = ["الشوط الأول", "الشوط الثاني", "نهاية الشوط الأول"];
      if (liveKeywords.some(k => status.includes(k))) {
        status = "جارية الآن";
      }

      if (status === "انتهت المباراة") {
        status = "انتهت";
      }

      if (status === "لم تبدأ") {
        status = "لم تبدأ بعد";
      }

      let statusClass = "";
      if (status === "جارية الآن") statusClass = "live";
      else if (status === "انتهت") statusClass = "ended";
      else if (status === "تأجلت" || status === "المباراة تأجلت") statusClass = "postponed";
      else if (status === "لم تبدأ بعد" || status === "بعد قليل") statusClass = "upcoming";
      else statusClass = "ended";

      if (statusClass === "upcoming") {
        return `
          <div class="match" id="${matchId}" data-match-id="${match["Match-id"]}">
            <div class="team" title="${leftTeam.Name}">
              <img src="${leftTeam.Logo}" alt="${leftTeam.Name}" loading="lazy" />
              <div class="team-name">${leftTeam.Name}</div>
            </div>
            <div class="center-info">
              <div class="score">${timeStr}</div>
              <div class="status ${statusClass}">${status}</div>
            </div>
            <div class="team" title="${rightTeam.Name}">
              <img src="${rightTeam.Logo}" alt="${rightTeam.Name}" loading="lazy" />
              <div class="team-name">${rightTeam.Name}</div>
            </div>
          </div>
        `;
      }

      return `
        <div class="match" id="${matchId}" data-match-id="${match["Match-id"]}">
          <div class="team" title="${leftTeam.Name}">
            <img src="${leftTeam.Logo}" alt="${leftTeam.Name}" loading="lazy" />
            <div class="team-name">${leftTeam.Name}</div>
          </div>
          <div class="center-info">
            <div class="score">${leftGoal} - ${rightGoal}</div>
            <div class="status ${statusClass}">${status}</div>
          </div>
          <div class="team" title="${rightTeam.Name}">
            <img src="${rightTeam.Logo}" alt="${rightTeam.Name}" loading="lazy" />
            <div class="team-name">${rightTeam.Name}</div>
          </div>
        </div>
      `;
    }

    function createLeagueHTML(league, leagueIndex) {
      const matchesHTML = league.Matches.map((match, matchIndex) => 
          createMatchHTML(match, leagueIndex, matchIndex)).join("");
      return `
        <div class="league">
          <div class="league-header">
            <img src="${league["Cup-Logo"]}" alt="${league["Cup-Name"]}" />
            <h2>${league["Cup-Name"]}</h2>
          </div>
          ${matchesHTML}
        </div>
      `;
    }

    async function loadMatches() {
      try {
        const formattedDate = getLocalDateString(selectedDate);
        const response = await fetch(`${PROXY}${API_URL}?date=${formattedDate}`);
        if (!response.ok) throw new Error("فشل تحميل البيانات");
        const data = await response.json();
        const container = document.getElementById("matches-container");

        if (!data.Leagues || data.Leagues.length === 0) {
          container.innerHTML = "<p>لا توجد مباريات في هذا التاريخ.</p>";
          return;
        }

        // تحديث واجهة المستخدم
        container.innerHTML = data.Leagues.map((league, index) => 
            createLeagueHTML(league, index)).join("");
        
        // إعداد مستمعي الأحداث للمباريات
        setTimeout(setupMatchListeners, 100);
        
      } catch (error) {
        document.getElementById("matches-container").innerHTML =
          `<p>حدث خطأ أثناء تحميل البيانات: ${error.message}</p>`;
      }
    }

    async function loadMatchDetails(matchId) {
      try {
        const response = await fetch(`${PROXY}${DETAILS_API_URL}${matchId}`);
        if (!response.ok) throw new Error("فشل تحميل تفاصيل المباراة");
        const data = await response.json();
        currentMatchDetails = data;
        renderMatchDetails(data);
      } catch (error) {
        document.getElementById("modalBody").innerHTML = `
          <div class="error-message">
            <p>حدث خطأ أثناء تحميل تفاصيل المباراة: ${error.message}</p>
          </div>
        `;
      }
    }

    function renderMatchDetails(data) {
      const leftTeam = data["Team-Left"];
      const rightTeam = data["Team-Right"];
      const matchInfo = data["Match_Info"] || {};
      const lineup = data["Lineup"] || {};
      const events = data["Events"] || [];
      const stats = data["Statistics"] || [];
      const penalty = data["Penalty_Shootout"] || null;
      
      // تحديد فئة الحالة
      let statusClass = "upcoming";
      if (data["Match-Status"].includes("جارية")) statusClass = "live";
      else if (data["Match-Status"].includes("انتهت")) statusClass = "ended";
      else if (data["Match-Status"].includes("تأجلت")) statusClass = "postponed";
      
      // تنسيق الحالة
      let formattedStatus = data["Match-Status"];
      if (formattedStatus.includes("الشوط الأول")) formattedStatus = "جارية - الشوط الأول";
      else if (formattedStatus.includes("الشوط الثاني")) formattedStatus = "جارية - الشوط الثاني";
      else if (formattedStatus === "انتهت المباراة") formattedStatus = "انتهت";
      else if (formattedStatus === "لم تبدأ") formattedStatus = "لم تبدأ بعد";
      
      // تحويل وقت المباراة
      const matchTime = parseDateFromParts(data["match_date_time"], data["Match-Start-Time"]);
      const formattedTime = matchTime || "غير متوفر";
      
      // إنشاء هيكل التبويبات
      let html = `
        <div class="match-details-header">
          <div class="match-teams-container">
            <div class="match-team">
              <img src="${leftTeam.Logo}" alt="${leftTeam.Name}" />
              <div class="match-team-name">${leftTeam.Name}</div>
            </div>
            
            <div class="match-score-container">
              <div class="match-score">${leftTeam.Goal || 0} - ${rightTeam.Goal || 0}</div>
            </div>
            
            <div class="match-team">
              <img src="${rightTeam.Logo}" alt="${rightTeam.Name}" />
              <div class="match-team-name">${rightTeam.Name}</div>
            </div>
          </div>
          
          <div class="match-status-container">
            <div class="match-status ${statusClass}">${formattedStatus}</div>
          </div>
        </div>

        <!-- تبويبات التفاصيل -->
        <div class="tabs-container">
          <div class="tab active" data-tab="info" tabindex="0"><i class="fas fa-info-circle"></i> المعلومات</div>
          <div class="tab" data-tab="lineup" tabindex="0"><i class="fas fa-users"></i> التشكيلة</div>
          <div class="tab" data-tab="events" tabindex="0"><i class="fas fa-list-ul"></i> الأحداث</div>
          <div class="tab" data-tab="stats" tabindex="0"><i class="fas fa-chart-bar"></i> الإحصائيات</div>
        </div>

        <!-- محتوى التبويب الأول (المعلومات) -->
        <div class="tab-content active" id="info-tab">
          <div class="match-info-grid">
            <div class="info-item">
              <div class="info-label"><i class="fas fa-trophy"></i> البطولة</div>
              <div class="info-value">${matchInfo["البطولة"] || "غير متوفر"}</div>
            </div>
            <div class="info-item">
              <div class="info-label"><i class="fas fa-flag"></i> الجولة</div>
              <div class="info-value">${matchInfo["الجولة"] || "غير متوفر"}</div>
            </div>
            <div class="info-item">
              <div class="info-label"><i class="fas fa-map-marker-alt"></i> الملعب</div>
              <div class="info-value">${matchInfo["ملعب_المباراة"] || "غير متوفر"}</div>
            </div>
            <div class="info-item">
              <div class="info-label"><i class="far fa-calendar-alt"></i> التاريخ</div>
              <div class="info-value">${matchInfo["تاريخ_المباراة"] || "غير متوفر"}</div>
            </div>
            <div class="info-item">
              <div class="info-label"><i class="far fa-clock"></i> الوقت</div>
              <div class="info-value">${formattedTime}</div>
            </div>
          </div>
      `;
      
      // معلومات الحكام والتحكيم
      if (matchInfo["حكم_الساحة"] || matchInfo["حكم_مساعد_1"] || matchInfo["حكم_تقنية_الفيديو_1"]) {
        html += `
          <h4 class="section-title"><i class="fas fa-whistle"></i> طاقم التحكيم</h4>
          <div class="referees-container">
            ${matchInfo["حكم_الساحة"] ? `
              <div class="referee-item">
                <span class="referee-role"><i class="fas fa-user-shield"></i> حكم الساحة :</span>
                <span class="referee-name">${matchInfo["حكم_الساحة"]}</span>
              </div>
            ` : ''}
            ${matchInfo["حكم_مساعد_1"] ? `
              <div class="referee-item">
                <span class="referee-role"><i class="fas fa-user-friends"></i> حكم مساعد 1 :</span>
                <span class="referee-name">${matchInfo["حكم_مساعد_1"]}</span>
              </div>
            ` : ''}
            ${matchInfo["حكم_مساعد_2"] ? `
              <div class="referee-item">
                <span class="referee-role"><i class="fas fa-user-friends"></i> حكم مساعد 2 :</span>
                <span class="referee-name">${matchInfo["حكم_مساعد_2"]}</span>
              </div>
            ` : ''}
            ${matchInfo["حكم_تقنية_الفيديو_1"] ? `
              <div class="referee-item">
                <span class="referee-role"><i class="fas fa-video"></i> حكم VAR :</span>
                <span class="referee-name">${matchInfo["حكم_تقنية_الفيديو_1"]}</span>
              </div>
            ` : ''}
          </div>
        `;
      }

      // معلومات البث
      if (matchInfo["القناة_الناقلة"] || matchInfo["المعلق"]) {
        html += `
          <h4 class="section-title"><i class="fas fa-tv"></i> معلومات البث</h4>
          <div class="match-info-grid">
            ${matchInfo["القناة_الناقلة"] ? `
              <div class="info-item">
                <div class="info-label"><i class="fas fa-satellite-dish"></i> القناة الناقلة</div>
                <div class="info-value">${matchInfo["القناة_الناقلة"]}</div>
              </div>
            ` : ''}
            ${matchInfo["المعلق"] ? `
              <div class="info-item">
                <div class="info-label"><i class="fas fa-microphone-alt"></i> المعلق</div>
                <div class="info-value">${matchInfo["المعلق"]}</div>
              </div>
            ` : ''}
          </div>
        `;
      }

      html += `</div> <!-- إغلاق تبويب المعلومات -->`;

      // تبويب التشكيلات
      html += `
        <div class="tab-content" id="lineup-tab">
      `;

      // التشكيلات
      if (lineup.Home_Team_Formation || lineup.Away_Team_Formation) {
        html += `
          <h4 class="section-title"><i class="fas fa-chess"></i> التشكيلات</h4>
          <div class="formations-container">
            <div class="formation">
              <div class="formation-title">${leftTeam.Name}</div>
              <div class="formation-value">${lineup.Home_Team_Formation || "غير متوفر"}</div>
              ${lineup.Home_Coach ? `
                <div class="coach-info">
                  <img src="${lineup.Home_Coach.image}" alt="${lineup.Home_Coach.title}" />
                  <div class="coach-name"><i class="fas fa-user-tie"></i> ${lineup.Home_Coach.title}</div>
                </div>
              ` : ''}
            </div>
            <div class="formation">
              <div class="formation-title">${rightTeam.Name}</div>
              <div class="formation-value">${lineup.Away_Team_Formation || "غير متوفر"}</div>
              ${lineup.Away_Coach ? `
                <div class="coach-info">
                  <img src="${lineup.Away_Coach.image}" alt="${lineup.Away_Coach.title}" />
                  <div class="coach-name"><i class="fas fa-user-tie"></i> ${lineup.Away_Coach.title}</div>
                </div>
              ` : ''}
            </div>
          </div>
        `;
      }

      // تشكيلة الفريق الأول
      if (lineup.Home_Lineup && lineup.Home_Lineup.length > 0) {
        html += `
          <h4 class="section-title"><i class="fas fa-users"></i> تشكيلة ${leftTeam.Name}</h4>
          <div class="players-list">
            ${lineup.Home_Lineup.map(player => `
              <div class="player-item">
                <img src="${player.player.image}" alt="${player.player.title}" />
                <div class="player-name"><i class="fas fa-user"></i> ${player.player.title}</div>
                <div class="player-number">${player.player.player_number}</div>
              </div>
            `).join('')}
          </div>
        `;
      }

      // تشكيلة الفريق الثاني
      if (lineup.Away_Lineup && lineup.Away_Lineup.length > 0) {
        html += `
          <h4 class="section-title"><i class="fas fa-users"></i> تشكيلة ${rightTeam.Name}</h4>
          <div class="players-list">
            ${lineup.Away_Lineup.map(player => `
              <div class="player-item">
                <img src="${player.player.image}" alt="${player.player.title}" />
                <div class="player-name"><i class="fas fa-user"></i> ${player.player.title}</div>
                <div class="player-number">${player.player.player_number}</div>
              </div>
            `).join('')}
          </div>
        `;
      }

      html += `</div> <!-- إغلاق تبويب التشكيلة -->`;

      // تبويب الأحداث
      html += `
        <div class="tab-content" id="events-tab">
      `;

      // الأحداث
      if (events.length > 0) {
        const filteredEvents = events.filter(event => event.minute !== "");
        
        if (filteredEvents.length > 0) {
          html += `
            <div class="match-events-section">
              <h4 class="section-title"><i class="fas fa-futbol"></i> أحداث المباراة</h4>
              <div class="events-line">
                ${filteredEvents.map(event => {
                  const eventIcon = getEventIcon(event.event_name);
                  const eventClass = getEventClass(event.event_name);
                  
                  let eventHtml = `
                    <div class="event-item ${eventClass}">
                      <div class="event-meta">
                        <div class="event-time">${event.minute || 'ـ'}'</div>
                        <div class="event-icon">${eventIcon}</div>
                      </div>
                      <div class="event-content">
                        <div class="event-main-info">
                  `;
                  
                  // معالجة كل نوع من الأحداث
                  switch(event.event_name) {
                    case "هدف":
                      eventHtml += `
                        <span class="event-player">${event.player_a}</span>
                        ${event.player_s ? `<span class="event-assist">(صناعة: ${event.player_s})</span>` : ''}
                      `;
                      break;
                      
                    case "تبديل لاعب":
                      eventHtml += `
                        <div class="substitution-container">
                          <span class="substitution-out">${event.player_a}</span>
                          <span class="substitution-arrow">→</span>
                          <span class="substitution-in">${event.player_s}</span>
                        </div>
                      `;
                      break;
                      
                    case "بطاقة صفراء":
                    case "بطاقة حمراء":
                    case "ضربة جزاء":
                      eventHtml += `<span class="event-player">${event.player_a}</span>`;
                      break;
                      
                    default:
                      eventHtml += event.event_name;
                  }
                  
                  eventHtml += `
                        </div>
                        <div class="event-type">${event.event_name}</div>
                      </div>
                    </div>
                  `;
                  return eventHtml;
                }).join('')}
              </div>
            </div>
          `;
        }
      }

      // ركلات الترجيح
      if (penalty && (penalty.Team1_Kicks || penalty.Team2_Kicks)) {
        html += `
          <h4 class="section-title"><i class="fas fa-crosshairs"></i> ركلات الترجيح</h4>
          <div class="penalty-shootout">
            <div class="penalty-teams-row" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
              <!-- الفريق الأول -->
              <div class="penalty-team-header" style="display: flex; flex-direction: column; align-items: center; margin-right: 10px;">
                <img src="${leftTeam.Logo}" alt="${leftTeam.Name}" class="penalty-team-logo" style="width: 50px; height: 50px; margin-bottom: 3px;">
                <div class="penalty-team-name" style="font-size: 0.9rem; margin-bottom: 3px;">${leftTeam.Name}</div>
                <div class="penalty-score" style="width: 30px; height: 30px; line-height: 30px;">${leftTeam["Penalty-Score"] || 0}</div>
              </div>
              
              <!-- VS في المنتصف -->
              <div class="vs-container" style="margin: 0 5px;">
                <span class="vs-text">VS</span>
              </div>
              
              <!-- الفريق الثاني -->
              <div class="penalty-team-header" style="display: flex; flex-direction: column; align-items: center; margin-left: 10px;">
                <img src="${rightTeam.Logo}" alt="${rightTeam.Name}" class="penalty-team-logo" style="width: 50px; height: 50px; margin-bottom: 3px;">
                <div class="penalty-team-name" style="font-size: 0.9rem; margin-bottom: 3px;">${rightTeam.Name}</div>
                <div class="penalty-score" style="width: 30px; height: 30px; line-height: 30px;">${rightTeam["Penalty-Score"] || 0}</div>
              </div>
            </div>

            <div class="penalty-kicks-container">
              <div class="penalty-kicks-column">
                ${penalty.Team1_Kicks ? penalty.Team1_Kicks.map((kick, index) => `
                  <div class="penalty-kick ${kick.outcome === "Scored" ? "scored" : "missed"}">
                    <div class="kick-number">${index + 1}</div>
                    <div class="player-info">
                      <div class="player-avatar-icon">
                        <i class="fas fa-user"></i>
                      </div>
                      <span class="player-name">${kick.player_name}</span>
                    </div>
                    <div class="kick-result">
                      ${kick.outcome === "Scored" ? '<i class="fas fa-check"></i>' : '<i class="fas fa-times"></i>'}
                    </div>
                  </div>
                `).join('') : ''}
              </div>
              
              <div class="penalty-separator"></div>
              
              <div class="penalty-kicks-column">
                ${penalty.Team2_Kicks ? penalty.Team2_Kicks.map((kick, index) => `
                  <div class="penalty-kick ${kick.outcome === "Scored" ? "scored" : "missed"}">
                    <div class="kick-number">${index + 1}</div>
                    <div class="player-info">
                      <div class="player-avatar-icon">
                        <i class="fas fa-user"></i>
                      </div>
                      <span class="player-name">${kick.player_name}</span>
                    </div>
                    <div class="kick-result">
                      ${kick.outcome === "Scored" ? '<i class="fas fa-check"></i>' : '<i class="fas fa-times"></i>'}
                    </div>
                  </div>
                `).join('') : ''}
              </div>
            </div>
          </div>
        `;
      }

      html += `</div> <!-- إغلاق تبويب الأحداث -->`;

      // تبويب الإحصائيات
      html += `
        <div class="tab-content" id="stats-tab">
      `;

      // الإحصائيات
      if (stats.length > 0) {
        html += `
          <h4 class="section-title"><i class="fas fa-chart-bar"></i> إحصائيات المباراة</h4>
          <div class="stats-comparison">
            <!-- رأس الإحصائيات مع شعارات الفريقين - تصميم جديد -->
            <div class="penalty-teams-row" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
              <!-- الفريق الأول -->
              <div class="penalty-team-header" style="display: flex; flex-direction: column; align-items: center; margin-right: 10px;">
                <img src="${leftTeam.Logo}" alt="${leftTeam.Name}" class="penalty-team-logo" style="width: 50px; height: 50px; margin-bottom: 3px;">
                <div class="penalty-team-name" style="font-size: 0.9rem; margin-bottom: 3px;">${leftTeam.Name}</div>
              </div>
              
              <!-- VS في المنتصف -->
              <div class="vs-container" style="margin: 0 5px;">
                <span class="vs-text">VS</span>
              </div>
              
              <!-- الفريق الثاني -->
              <div class="penalty-team-header" style="display: flex; flex-direction: column; align-items: center; margin-left: 10px;">
                <img src="${rightTeam.Logo}" alt="${rightTeam.Name}" class="penalty-team-logo" style="width: 50px; height: 50px; margin-bottom: 3px;">
                <div class="penalty-team-name" style="font-size: 0.9rem; margin-bottom: 3px;">${rightTeam.Name}</div>
              </div>
            </div>

            <!-- قائمة الإحصائيات -->
            <div class="stats-list">
              ${stats.map(stat => {
                // هنا يتم تصحيح المشكلة بتبديل Team1_Value و Team2_Value
                const team1Value = parseFloat(stat.Team2_Value) || 0; // تغيير من Team1_Value إلى Team2_Value
                const team2Value = parseFloat(stat.Team1_Value) || 0; // تغيير من Team2_Value إلى Team1_Value
                const total = team1Value + team2Value;
                const team1Percent = total > 0 ? (team1Value / total) * 100 : 50;
                const isPossession = stat.Name.includes('استحواذ');
                
                return `
                  <div class="stat-item">
                    <div class="stat-row">
                      <div class="stat-value home-value">${team1Value}${isPossession ? '%' : ''}</div>
                      <div class="stat-name">${stat.Name}</div>
                      <div class="stat-value away-value">${team2Value}${isPossession ? '%' : ''}</div>
                    </div>
                    <div class="progress-bar-container">
                      <div class="home-progress" style="width: ${team1Percent}%"></div>
                      <div class="away-progress" style="width: ${100 - team1Percent}%"></div>
                    </div>
                  </div>
                `;
              }).join('')}
            </div>
          </div>
        `;
      }

      html += `</div> <!-- إغلاق تبويب الإحصائيات -->`;

      document.getElementById("modalBody").innerHTML = html;
      
      // إضافة مستمعين لأحداث التبويبات
      setupTabListeners();
      
      // التركيز على التبويب الأول
      const tabs = document.querySelectorAll('.tab');
      if (tabs.length > 0) {
        tabs[0].focus();
      }
      
      // إضافة مستمع لحدث التمرير في النافذة المنبثقة
      const modalContent = document.querySelector('.modal-content');
      modalContent.addEventListener('scroll', handleModalScroll);
    }

    function setupTabListeners() {
      const tabs = document.querySelectorAll('.tab');
      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          // إزالة الفعالية من جميع التبويبات
          document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
          
          // تفعيل التبويب المحدد
          tab.classList.add('active');
          const tabId = tab.getAttribute('data-tab');
          document.getElementById(`${tabId}-tab`).classList.add('active');
          
          // تحديث الفهرس الحالي للتبويب
          currentTabIndex = Array.from(tabs).indexOf(tab);
        });
      });
    }

    function getEventIcon(eventName) {
      switch(eventName) {
        case "هدف": return '<i class="fas fa-futbol goal-icon"></i>';
        case "تبديل لاعب": return '<i class="fas fa-exchange-alt sub-icon"></i>';
        case "بطاقة صفراء": return '<i class="fas fa-square yellow-card-icon"></i>';
        case "بطاقة حمراء": return '<i class="fas fa-square red-card-icon</i>';
        case "ضربة جزاء": return '<i class="fas fa-dot-circle penalty-icon"></i>';
        default: return '<i class="fas fa-circle"></i>';
      }
    }

    function getEventClass(eventName) {
      return eventName.replace(/\s+/g, '-').toLowerCase();
    }

    function showMatchDetails(matchId) {
      const modal = document.getElementById("matchDetailsModal");
      const modalBody = document.getElementById("modalBody");
      
      // إظهار رسالة التحمين
      modalBody.innerHTML = `
        <div class="loading-details">
          <div class="loading-spinner"></div>
          <p>جاري تحميل تفاصيل المباراة</p>
        </div>
      `;
      
      // إظهار النافذة المنبثقة
      modal.classList.add("active");
      
      // تحميل تفاصيل المباراة
      loadMatchDetails(matchId);
    }

    function closeModal() {
      document.getElementById("matchDetailsModal").classList.remove("active");
    }

    function setupMatchListeners() {
      document.querySelectorAll('.match').forEach(match => {
        match.addEventListener('click', function() {
          const matchId = this.getAttribute('data-match-id');
          if (matchId) {
            showMatchDetails(matchId);
          }
        });
      });
    }

    function handleScroll() {
      const scrollToTopBtn = document.getElementById('scrollToTop');
      if (window.scrollY > 300) {
        scrollToTopBtn.classList.add('visible');
      } else {
        scrollToTopBtn.classList.remove('visible');
      }
    }

    function handleModalScroll() {
      const modalContent = document.querySelector('.modal-content');
      const scrollToTopBtn = document.getElementById('scrollToTop');
      
      if (modalContent.scrollTop > 100) {
        scrollToTopBtn.classList.add('visible');
      } else {
        scrollToTopBtn.classList.remove('visible');
      }
    }

    document.getElementById("prev-day").addEventListener("click", () => {
      selectedDate.setDate(selectedDate.getDate() - 1);
      updateDateDisplay();
      loadMatches();
    });

    document.getElementById("next-day").addEventListener("click", () => {
      selectedDate.setDate(selectedDate.getDate() + 1);
      updateDateDisplay();
      loadMatches();
    });

    document.getElementById("refreshIcon").addEventListener("click", function () {
      const icon = this.querySelector("i");
      icon.classList.add("rotate");
      setTimeout(() => {
        icon.classList.remove("rotate");
        location.reload();
      }, 600);
    });

    document.getElementById('closeModal').addEventListener('click', closeModal);
    document.getElementById('matchDetailsModal').addEventListener('click', (e) => {
      if (e.target === document.getElementById('matchDetailsModal')) {
        closeModal();
      }
    });
    
    document.getElementById('scrollToTop').addEventListener('click', () => {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    });
    
    window.addEventListener('scroll', handleScroll);

    // التهيئة الأولية
    updateDateDisplay();
    loadMatches();
    
    // تحديث البيانات كل 30 ثانية
    setInterval(() => {
      loadMatches();
    }, 30000);
  </script>
</body>
</html>